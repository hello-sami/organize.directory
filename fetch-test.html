<!DOCTYPE html>
<html>

<head>
    <title>Fetch API Test for Web3Forms</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input,
        textarea {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }

        button {
            background: #a30000;
            color: white;
            border: none;
            padding: 10px 15px;
            cursor: pointer;
        }

        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .success {
            background-color: #e8f5e9;
            color: #2e7d32;
        }

        .error {
            background-color: #ffebee;
            color: #c62828;
        }
    </style>
</head>

<body>
    <h1>Web3Forms Test using Fetch API</h1>

    <p>This form submits directly using the Fetch API instead of traditional form submission.</p>

    <form id="contactForm">
        <div class="form-group">
            <label for="name">Name:</label>
            <input type="text" id="name" name="name" required>
        </div>

        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email">
        </div>

        <div class="form-group">
            <label for="message">Message:</label>
            <textarea id="message" name="message" rows="4" required></textarea>
        </div>

        <button type="button" id="submitButton">Send Message via Fetch API</button>

        <div id="result" class="result">
            <p id="resultMessage"></p>
            <div id="responseDetails"></div>
        </div>
    </form>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const submitButton = document.getElementById('submitButton');
            const form = document.getElementById('contactForm');
            const resultDiv = document.getElementById('result');
            const resultMessage = document.getElementById('resultMessage');
            const responseDetails = document.getElementById('responseDetails');

            submitButton.addEventListener('click', function () {
                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value || 'anonymous@example.com';
                const message = document.getElementById('message').value;

                if (!name || !message) {
                    alert('Please fill out the required fields');
                    return;
                }

                // Show loading status
                resultDiv.className = 'result';
                resultDiv.style.display = 'block';
                resultMessage.textContent = 'Sending message...';
                responseDetails.textContent = '';

                // Prepare the form data
                const formData = new FormData();
                formData.append('access_key', '66d4bcac-1c6a-4c7c-b544-c5b2a4c51f4f');
                formData.append('name', name);
                formData.append('email', email);
                formData.append('message', message);
                formData.append('from_name', 'Organize Directory Contact Form');
                formData.append('subject', 'New Contact Form Submission');
                formData.append('botcheck', ''); // Honeypot

                // Send the request
                fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    body: formData
                })
                    .then(response => response.json())
                    .then(data => {
                        console.log('API response:', data);

                        if (data.success) {
                            // Success!
                            resultDiv.className = 'result success';
                            resultMessage.textContent = 'Message sent successfully!';
                            responseDetails.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;

                            // Reset the form
                            form.reset();

                            // Redirect to thank-you page
                            setTimeout(() => {
                                window.location.href = 'https://organize.directory/thank-you';
                            }, 2000);
                        } else {
                            // Error from API
                            resultDiv.className = 'result error';
                            resultMessage.textContent = 'Error: ' + (data.message || 'Unknown error occurred');
                            responseDetails.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        resultDiv.className = 'result error';
                        resultMessage.textContent = 'Network error: ' + error.message;
                        responseDetails.textContent = 'Check your internet connection or try again later.';
                    });
            });
        });
    </script>
</body>

</html>