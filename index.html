<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

    <!-- Preload critical resources -->
    <link rel="preload" href="/styles.css?v=1.1.9" as="style">
    <script>
        // Preload CSS to reduce flickering
        function preloadCriticalCSS() {
            const criticalStyles = ['/styles.css?v=1.1.9'];
            criticalStyles.forEach(href => {
                const link = document.createElement('link');
                link.rel = 'preload';
                link.href = href;
                link.as = 'style';
                document.head.appendChild(link);
            });
        }
        // Execute immediately
        preloadCriticalCSS();
    </script>

    <!-- Force mobile layout with inline CSS -->
    <style>
        /* Enhanced styling for homepage */
        body.page-home {
            background: linear-gradient(160deg, #fff5f5 0%, #fff8f8 100%);
        }

        body.page-home .content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        body.page-home h1 {
            font-size: 4rem;
            color: #bc2a2a;
            text-align: center;
            margin-bottom: 2rem;
            text-shadow: 1px 1px 0px rgba(0, 0, 0, 0.05);
            position: relative;
        }

        body.page-home h1:after {
            content: "";
            display: block;
            width: 100px;
            height: 4px;
            background: #c82525;
            margin: 0.5rem auto 0;
            border-radius: 2px;
        }

        .homepage-content {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
        }

        .homepage-content:before {
            content: "";
            position: absolute;
            top: -30px;
            left: 10%;
            right: 10%;
            height: 1px;
            background: rgba(200, 37, 37, 0.1);
            z-index: -1;
        }

        .find-groups-buttons {
            margin: 2.5rem auto;
            max-width: 800px;
        }

        .buttons-container {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
        }

        .find-groups-button {
            background-color: #c82525;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px rgba(200, 37, 37, 0.2);
            border: 2px solid #c82525;
            flex: 1;
            text-align: center;
        }

        .find-groups-button:hover {
            background-color: #e02e2e;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(200, 37, 37, 0.25);
        }

        .find-groups-button:active {
            transform: translateY(0px);
            box-shadow: 0 2px 4px rgba(200, 37, 37, 0.3);
        }

        .button-text {
            font-family: "Saira Semi Condensed", sans-serif;
        }

        .initiative-stats {
            background: white;
            border: 2px solid #c82525;
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem auto 3rem;
            max-width: 800px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .initiative-stats:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 6px;
            background: linear-gradient(90deg, #c82525, #e02e2e);
        }

        .initiative-stats:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            transform: translateY(-3px);
        }

        .stats-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 0.5rem 1rem;
            position: relative;
        }

        .stat-item:not(:last-child):after {
            content: "";
            position: absolute;
            right: -10px;
            top: 20%;
            bottom: 20%;
            width: 1px;
            background: rgba(200, 37, 37, 0.1);
        }

        .stat-number {
            font-size: 3.5rem;
            font-weight: 800;
            color: #c82525;
            line-height: 1;
            margin-bottom: 0.75rem;
            font-family: "Saira Semi Condensed", sans-serif;
        }

        .stat-label {
            font-size: 1.1rem;
            font-weight: 700;
            color: #c82525;
            text-transform: uppercase;
            font-family: "Saira Semi Condensed", sans-serif;
            letter-spacing: 0.05em;
        }

        @media (max-width: 480px) {

            /* Make homepage title bigger and add margin */
            body.page-home h1 {
                font-size: 2.5rem !important;
                margin-bottom: 2.5rem !important;
                padding-top: 0.75rem !important;
                padding-bottom: 0.5rem !important;
            }

            /* Force hide regular stats */
            .stat-number,
            .stat-label {
                display: none !important;
            }

            /* Force show mobile labels */
            .stat-mobile-label {
                display: block !important;
                font-size: 1.4rem !important;
                font-weight: 700 !important;
                text-align: left !important;
                font-family: "Saira Semi Condensed", sans-serif !important;
                color: #c82525 !important;
                line-height: 1.2 !important;
            }

            /* Force vertical layout */
            .stats-container {
                display: flex !important;
                flex-direction: column !important;
                gap: 1.2rem !important;
                width: 100% !important;
            }

            .stat-item {
                width: 100% !important;
                text-align: left !important;
                padding: 0 0.5rem !important;
            }

            .initiative-stats {
                padding: 1.5rem !important;
                margin: 0.75rem auto 1.5rem !important;
                border-width: 1px !important;
            }

            .find-groups-buttons {
                margin: 0 auto 2rem;
            }

            .buttons-container {
                flex-direction: column;
                gap: 1rem;
            }

            .find-groups-button {
                text-align: center;
                justify-content: center;
                display: flex;
            }
        }

        /* Ensure horizontal layout for larger screens */
        @media (min-width: 481px) {
            .stat-mobile-label {
                display: none !important;
            }

            .stat-number,
            .stat-label {
                display: block !important;
            }

            .stats-container {
                display: flex !important;
                flex-direction: row !important;
                justify-content: space-around !important;
                align-items: center !important;
            }

            .stat-item {
                display: flex !important;
                flex-direction: column !important;
                align-items: center !important;
                text-align: center !important;
            }
        }
    </style>

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <meta name="description"
        content="Daily updates and resources for mutual aid networks and grassroots initiatives across different cities.">

    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="The Organize Directory">
    <meta property="og:description"
        content="Daily updates and resources for mutual aid networks and grassroots initiatives across different cities.">
    <meta property="og:image" content="https://organize.directory/preview.png">
    <meta property="og:url" content="https://organize.directory">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">

    <meta name="color-scheme" content="light">
    <title>Organize Directory - Find Local Action Groups</title>

    <!-- URL Normalizer - Reduces worker calls -->
    <script>
        // Simplified and optimized link handling
        document.addEventListener('click', function (e) {
            // Find clicked anchor element
            let anchor = e.target.closest('a');
            if (!anchor) return;

            // Only handle internal links
            let href = anchor.getAttribute('href');
            if (!href || href.startsWith('http') || href.startsWith('#')) return;

            // Handle trailing slashes consistently
            if (href.endsWith('/')) {
                href = href.slice(0, -1);
            }

            // Skip processing for root path
            if (href === '' || href === '/') return;

            // Combine conditional checks for better performance
            const needsHtml = !href.includes('.') && !href.includes('?');
            const isSpecialPath = href.match(/^\/(cities|states|topics|posts)\/[^/]+$/);

            if (isSpecialPath || needsHtml) {
                e.preventDefault();
                window.location.href = href + '.html';
            }
        });
    </script>

    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">

    <!-- Critical CSS -->
    <link rel="stylesheet" href="/styles.css?v=1.1.9">

    <!-- Non-blocking font loading -->
    <link
        href="https://fonts.googleapis.com/css2?family=Saira+Semi+Condensed:wght@400;500;600;700;800&family=Inter:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Mobile menu script - Load with defer to ensure it runs after DOM is ready -->
    <script src="/mobile-menu.js?v=1.0.1" defer></script>

    <!-- Initialize Components Immediately -->
    <script type="module">
        // Import sidebar as early as possible
        import('/components/sidebar.js?v=1.0.9')
            .then(module => {
                const { initializeSidebar, checkAndInitializeSidebar } = module;
                // Initialize sidebar with early detection
                checkAndInitializeSidebar('home');

                // Additional initialization can wait for DOMContentLoaded
                document.addEventListener('DOMContentLoaded', function () {
                    // Reset nav-group-title
                    const navGroupTitles = document.querySelectorAll('.nav-group-title');
                    navGroupTitles.forEach(title => {
                        title.classList.add('reset-nav-group');
                    });
                });
            })
            .catch(error => console.error('Error initializing sidebar:', error));

        // Initialize other components after DOM is loaded
        document.addEventListener('DOMContentLoaded', function () {
            import('/utils/init.js?v=1.0.1')
                .then(module => {
                    const { initializeComponents } = module;
                    initializeComponents({});
                })
                .catch(error => console.error('Error initializing components:', error));
        });
    </script>
</head>

<body class="page-home">
    <div class="layout">
        <div id="sidebar-placeholder"></div>

        <main class="content" role="main">
            <header class="page-header"></header>

            <h1>The Organize Directory</h1>

            <div class="homepage-content">
                <section class="find-groups-buttons">
                    <div class="buttons-container">
                        <a href="/location.html" class="find-groups-button">
                            <span class="button-text">Find Local Groups</span>
                        </a>
                        <a href="/topics.html" class="find-groups-button">
                            <span class="button-text">Browse National Groups</span>
                        </a>
                    </div>
                </section>

                <section class="initiative-stats">
                    <div class="stats-container">
                        <div class="stat-item">
                            <span class="stat-number">2,154</span>
                            <span class="stat-label">GROUPS</span>
                            <span class="stat-mobile-label">GROUPS: 2,154</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">343</span>
                            <span class="stat-label">CITIES</span>
                            <span class="stat-mobile-label">CITIES: 343</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">41</span>
                            <span class="stat-label">CATEGORIES</span>
                            <span class="stat-mobile-label">CATEGORIES: 41</span>
                        </div>
                    </div>
                </section>
            </div>

            <script>
                // Force mobile styles immediately on load and resize
                function updateStatDisplay() {
                    if (window.innerWidth <= 480) {
                        // Make h1 bigger and add more margin
                        const h1Element = document.querySelector('body.page-home h1');
                        if (h1Element) {
                            h1Element.style.cssText = 'font-size: 2.5rem !important; margin-bottom: 2.5rem !important; padding-top: 0.75rem !important; padding-bottom: 0.5rem !important;';
                        }

                        // Hide regular stats with !important
                        document.querySelectorAll('.stat-number, .stat-label').forEach(el => {
                            el.style.cssText = 'display: none !important';
                        });

                        // Show mobile labels with !important
                        document.querySelectorAll('.stat-mobile-label').forEach(el => {
                            el.style.cssText = 'display: block !important; font-size: 1.4rem !important; font-weight: 700 !important; text-align: left !important; font-family: "Saira Semi Condensed", sans-serif !important; color: #c82525 !important;';
                        });

                        // Make stat items display vertically with !important
                        document.querySelector('.stats-container').style.cssText = 'display: flex !important; flex-direction: column !important; gap: 1.2rem !important; width: 100% !important;';

                        // Style each stat item with !important
                        document.querySelectorAll('.stat-item').forEach(el => {
                            el.style.cssText = 'width: 100% !important; text-align: left !important; padding: 0 0.5rem !important;';
                        });

                        // Style initiative-stats for mobile
                        const statsContainer = document.querySelector('.initiative-stats');
                        if (statsContainer) {
                            statsContainer.style.cssText = 'padding: 1.5rem !important; margin: 0.75rem auto 1.5rem !important; border-width: 1px !important; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05) !important;';
                        }

                        // Style buttons for mobile
                        document.querySelector('.buttons-container').style.cssText = 'flex-direction: column !important; gap: 1rem !important;';
                        document.querySelectorAll('.find-groups-button').forEach(el => {
                            el.style.cssText = 'display: flex !important; justify-content: center !important; text-align: center !important;';
                        });
                    } else {
                        // Reset h1 styles for larger screens
                        const h1Element = document.querySelector('body.page-home h1');
                        if (h1Element) {
                            h1Element.style.cssText = '';
                        }

                        // Reset styles for larger screens - horizontal layout
                        document.querySelectorAll('.stat-number, .stat-label').forEach(el => {
                            el.style.cssText = '';  // Remove inline styles
                        });

                        // Hide mobile labels
                        document.querySelectorAll('.stat-mobile-label').forEach(el => {
                            el.style.cssText = 'display: none !important;';
                        });

                        // Reset container to horizontal layout
                        document.querySelector('.stats-container').style.cssText = '';

                        // Reset stat items
                        document.querySelectorAll('.stat-item').forEach(el => {
                            el.style.cssText = '';
                        });

                        // Reset initiative-stats
                        const statsContainer = document.querySelector('.initiative-stats');
                        if (statsContainer) {
                            statsContainer.style.cssText = '';
                        }

                        // Reset buttons
                        document.querySelector('.buttons-container').style.cssText = '';
                        document.querySelectorAll('.find-groups-button').forEach(el => {
                            el.style.cssText = '';
                        });
                    }
                }

                // Run on load
                updateStatDisplay();

                // Run immediately
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', updateStatDisplay);
                } else {
                    updateStatDisplay();
                }

                // Run on resize
                window.addEventListener('resize', updateStatDisplay);

                // Force a check after a short delay to catch any late rendering issues
                setTimeout(updateStatDisplay, 100);
                setTimeout(updateStatDisplay, 500);
                setTimeout(updateStatDisplay, 1000);
            </script>

            <!-- <section class="daily-log" aria-labelledby="log-heading">
                <h2 id="log-heading">Calls to Action</h2>
                <div id="posts-list" class="posts-list">
                    <div class="loading-indicator">Loading posts...</div>
                </div>
            </section> -->
        </main>
    </div>

    <!-- Mobile menu overlay -->
    <div class="mobile-menu-overlay"></div>

    <!-- Mobile menu button -->
    <button class="mobile-menu-button" aria-label="Toggle navigation menu">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
    </button>
</body>

</html>